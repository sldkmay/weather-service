# Погодный сервис на Django

## Описание

Веб-приложение для просмотра и управления погодными данными по городам. Пользователи могут регистрироваться, добавлять города в избранное, просматривать актуальную погоду и прогнозы, а также получать оповещения о погодных явлениях.

---

## Основной функционал

- Регистрация и аутентификация пользователей
- Просмотр погодных данных по всем городам (только чтение)
- Добавление городов в избранное ("Мои города")
- CRUD (создание, просмотр, удаление) погодных данных только для избранных городов пользователя
- Фильтрация городов по стране и региону
- Просмотр прогнозов и оповещений о погоде
- Админ-панель с удобным управлением всеми моделями
- Автоматическая синхронизация погодных данных через API (по расписанию)

---

## Модели и связи

- **City** — город (название, регион, страна, координаты, часовой пояс)
- **WeatherCondition** — погодное состояние (текст, иконка, код)
- **WeatherData** — погодные данные для города (температура, влажность, ветер и др.)
- **Forecast** — прогноз погоды на дату для города
- **UserFavoriteCity** — связь "пользователь — любимый город" (с датой добавления)
- **WeatherAlert** — оповещение о погоде для города
- **UserProfile** — профиль пользователя с M2M-связью к избранным городам

**Связи:**
- Один город может иметь много погодных данных, прогнозов и оповещений
- Один пользователь может добавить много городов в избранное (через UserFavoriteCity и UserProfile)
- Погодные данные и прогнозы ссылаются на погодное состояние (WeatherCondition)

---

## Установка и запуск

1. **Клонируйте репозиторий:**
   ```bash
   git clone <repo-url>
   cd weather
   ```
2. **Установите зависимости:**
   ```bash
   pip install -r requirements.txt
   ```
3. **Настройте переменные окружения:**
   - В файле `weather/settings.py` укажите ваш API-ключ для WeatherAPI:
     ```python
     WEATHER_API_KEY = 'ваш_ключ'
     ```
4. **Примените миграции:**
   ```bash
   python manage.py migrate
   ```
5. **Создайте суперпользователя (для доступа в админку):**
   ```bash
   python manage.py createsuperuser
   ```
6. **Запустите сервер:**
   ```bash
   python manage.py runserver
   ```

---

## Синхронизация погодных данных

- Для массового обновления погодных данных используйте команду:
  ```bash
  python manage.py sync_weather
  ```
- Для наполнения тестовыми данными из API:
  ```bash
  python manage.py seed_data
  ```
- Рекомендуется настроить автоматический запуск синхронизации через планировщик задач (например, Windows Task Scheduler или cron).

---

## Тестирование

- Для запуска тестов:
  ```bash
  python manage.py test core
  ```
- Покрытие: тесты моделей, форм, представлений, валидации и edge-case сценариев.

---

## Структура проекта

- `core/` — основное приложение (модели, представления, формы, фильтры, шаблоны)
- `core/management/commands/` — кастомные management-команды для работы с погодными данными
- `core/static/core/style.css` — стили
- `core/templates/core/` — шаблоны (Bootstrap)
- `weather/settings.py` — настройки проекта
- `requirements.txt` — зависимости

---

## Админ-панель

- Доступна по адресу `/admin/`
- Кастомизирована для удобного управления всеми моделями
- Поддержка поиска, фильтрации, readonly-полей и отображения связанных данных

---

## Авторизация и регистрация

- Регистрация с валидацией уникальности логина и email, подтверждением пароля
- После регистрации пользователь автоматически входит в систему
- Навигация и доступ к "Моим городам" только для авторизованных пользователей

